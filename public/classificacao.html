<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena Tabelas - Classificação</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background-color: #050505; color: #eee; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .glass-card { background: #111; border: 1px solid #222; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .tab-btn { border-bottom: 3px solid transparent; transition: 0.3s; color: #888; }
        .tab-btn.active { border-bottom: 3px solid #2563eb; color: #fff; font-weight: bold; }
        tr { border-bottom: 1px solid #1a1a1a; transition: 0.2s; }
        tr:hover { background: #161616; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-5xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-10 text-white tracking-tight">Estatísticas de Futebol</h1>

        <nav class="flex overflow-x-auto gap-6 mb-8 border-b border-zinc-800 justify-start md:justify-center scrollbar-hide">
            <button onclick="carregar('BR', this)" class="tab-btn pb-3 px-2 active">Brasil</button>
            <button onclick="carregar('PL', this)" class="tab-btn pb-3 px-2">Inglaterra</button>
            <button onclick="carregar('ES', this)" class="tab-btn pb-3 px-2">Espanha</button>
            <button onclick="carregar('IT', this)" class="tab-btn pb-3 px-2">Itália</button>
            <button onclick="carregar('DE', this)" class="tab-btn pb-3 px-2">Alemanha</button>
            <button onclick="carregar('FR', this)" class="tab-btn pb-3 px-2">França</button>
        </nav>

        <div class="glass-card rounded-xl overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-center">
                    <thead class="bg-zinc-900 text-zinc-500 text-xs uppercase tracking-widest">
                        <tr>
                            <th class="p-4 text-left">Pos</th>
                            <th class="p-4 text-left">Clube</th>
                            <th class="p-4">PTS</th>
                            <th class="p-4">PJ</th>
                            <th class="p-4">VIT</th>
                            <th class="p-4">SG</th>
                            <th class="p-4 hidden md:table-cell">GP/GC</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-corpo" class="text-sm md:text-base">
                        </tbody>
                </table>
            </div>
            <div id="loading" class="p-20 text-center text-zinc-600 font-medium">Carregando dados do Supabase...</div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = "https://sihunefyfkecumbiyxva.supabase.co";
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNpaHVuZWZ5ZmtlY3VtYml5eHZhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY0MDg5MzgsImV4cCI6MjA4MTk4NDkzOH0.qgjbdCe1hfzcuglS6AAj6Ua0t45C2GOKH4r3JCpRn_A"; // Substitua pela sua chave 'anon public'
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function carregar(liga, elemento) {
            // Gerenciar estado dos botões
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            elemento.classList.add('active');

            const corpo = document.getElementById('tabela-corpo');
            const loader = document.getElementById('loading');
            
            corpo.innerHTML = "";
            loader.style.display = "block";

            const { data, error } = await supabaseClient
                .from('tabelas_ligas')
                .select('*')
                .eq('liga', liga)
                .order('posicao', { ascending: true });

            loader.style.display = "none";

            if (data && data.length > 0) {
                data.forEach(clube => {
                    corpo.innerHTML += `
                        <tr>
                            <td class="p-4 text-left font-mono text-zinc-500">${clube.posicao}º</td>
                            <td class="p-4 text-left flex items-center gap-3">
                                <img src="${clube.escudo}" class="w-6 h-6 object-contain" onerror="this.src='https://via.placeholder.com/24'">
                                <span class="font-bold text-zinc-200">${clube.time}</span>
                            </td>
                            <td class="p-4 font-black text-blue-500">${clube.pontos}</td>
                            <td class="p-4 text-zinc-400">${clube.jogos}</td>
                            <td class="p-4 text-green-500/80">${clube.vitorias}</td>
                            <td class="p-4 font-medium ${clube.sg >= 0 ? 'text-emerald-500' : 'text-rose-500'}">${clube.sg}</td>
                            <td class="p-4 hidden md:table-cell text-zinc-600 text-xs">${clube.gols_pro} : ${clube.gols_contra}</td>
                        </tr>
                    `;
                });
            } else {
                corpo.innerHTML = `<tr><td colspan="7" class="p-10 text-zinc-600">Nenhum dado encontrado para a liga ${liga}. Rode o crawler.</td></tr>`;
            }
        }

        // Inicialização automática
        window.onload = () => {
            const btnBrasil = document.querySelector('.tab-btn');
            carregar('BR', btnBrasil);
        }
    </script>
</body>
</html>
